import codecs
import string
from itertools import cycle

# break repeating-key [xorz]

##计算a,b之间的汉明距离res
# def haming(a,b):
#     res = 0
#     for x,y in zip(a,b): #打包为元组的列表，个数与最短的一致
#         res += bin(ord(x)^ord(y)).count(1) #异或之后计算1的数量即两个字母之间的汉明距离
#     #print(res)
#     return res
#
#
# def break_single_key_xor(text):
#     key = 0
#     possible_space = 0
#     max_possible = 0
#     letters = string.ascii_letters # 所有的大小写英文字母
#     for a in range(0,len(text)):
#         maxpossible = 0
#         for b in range(0,len(text)):
#             if(a == b):
#                 continue
#             c = ord(text[a])^ord(text[b])
#             if chr(c) not in letters and c!=0:
#                 continue
#             maxpossible += 1
#         if maxpossible>max_possible:
#             max_possible = maxpossible
#             possible_space = a
#     key = ord(text[possible_space])^0x20
#     return chr(key)
#
# cipher = '49380d773440222d1b421b3060380c3f403c3844791b202651306721135b6229294a3c3222357e766b2f15561b35305e3c3b670e49382c295c6c170553577d3a2b791470406318315d753f03637f2b614a4f2e1c4f21027e227a4122757b446037786a7b0e37635024246d60136f7802543e4d36265c3e035a725c6322700d626b345d1d6464283a016f35714d434124281b607d315f66212d671428026a4f4f79657e34153f3467097e4e135f187a21767f02125b375563517a3742597b6c394e78742c4a725069606576777c314429264f6e330d7530453f22537f5e3034560d22146831456b1b72725f30676d0d5c71617d48753e26667e2f7a334c731c22630a242c7140457a42324629064441036c7e646208630e745531436b7c51743a36674c4f352a5575407b767a5c747176016c0676386e403a2b42356a727a04662b4446375f36265f3f124b724c6e346544706277641025063420016629225b43432428036f29341a2338627c47650b264c477c653a67043e6766152a485c7f33617264780656537e5468143f305f4537722352303c3d4379043d69797e6f3922527b24536e310d653d4c33696c635474637d0326516f745e610d773340306621105a7361654e3e392970687c2e335f3015677d4b3a724a4659767c2f5b7c16055a126820306c14315d6b59224a27311f747f336f4d5974321a22507b22705a226c6d446a37375761423a2b5c29247163046d7e47032244377508300751727126326f117f7a38670c2b23203d4f27046a5c5e1532601126292f577776606f0c6d0126474b2a73737a41316362146e581d7c1228717664091c'
# salt="WeAreDe1taTeam"
#
# i = 0
# text = ''
# si = cycle(salt)
# while i < 1199:
#   text += chr(int(("0x"+cipher[i:i+2]),16) ^ ord(next(si)))
#   i += 2
# print(text)
#
# normalized_distances = []
#
# for keysize in range(2,40):
#     c1 = text[:keysize]
#     c2 = text[keysize:keysize*2]
#     c3 = text[keysize*2:keysize*3]
#     c4 = text[keysize*3:keysize*4]
#     c5 = text[keysize*4:keysize*5]
#     c6 = text[keysize*5:keysize*6]
#
#     normalized_distance = float(
#         haming(c1,c2)+
#         haming(c2,c3)+
#         haming(c3,c4)+
#         haming(c4,c5)+
#         haming(c5,c6)
#         )/(keysize*5)
#     normalized_distances.append((keysize,normalized_distance))
#
# normalized_distances = sorted(normalized_distances,key=lambda x:x[1])
# print(normalized_distances)
#
# for keysize,_ in normalized_distances[:5]:
#     block_bytes = [[] for _ in range(keysize)] # 列表的列表
#     for i,byte in enumerate(text):
#         block_bytes[i%keysize].append(byte)
#     keys = ''
#     for bbytes in block_bytes:
#         keys += break_single_key_xor(bbytes)
#     key = cycle(keys)
#     plaintext = ''.join(chr(ord(next(key))^ord(p)) for p in text)
#     print("keysize:",keysize)
#     print("key is:",keys)
#     print(plaintext)


# Lfsr

# from Crypto.Util.strxor import strxor
# import codecs
# cip = open('cipher.txt', 'rb').read()
# msg = open('Plain.txt', 'rb').read()
#
# print(codecs.encode(strxor(cip, msg)[:8], 'hex'))
#
# key = '0123456789abcdef'

#
#
from Crypto.Util.number import long_to_bytes



def lfsr(R, mask):
    # 左移1位：保留末尾 63 位，在最后添加一个0
    output = (R << 1) & 0xffffffffffffffff

    # i：保留 R 的前 0、1、3、4位
    i = (R & mask) & 0xffffffffffffffff

    lastbit = 0
    while i != 0:
        lastbit ^= (i & 1)
        i = i >> 1
    # lastbit：统计 i 里面有多少个1, 奇数个则为1, 偶数个则为0

    # output: R 左移1位，再添加 lastbit
    output ^= lastbit
    return (output, lastbit)
#
#
# cip = open('flag_encode.txt', 'rb').read()
# a = ''.join([chr(int(b, 16)) for b in [key[i:i + 2] for i in range(0, len(key), 2)]])
#
# ans = ""
#
# for i in range(len(a)):
#     ans += (chr((cip[i] ^ ord(a[i]))))
#
# lent = len(cip)
#
# for i in range(len(a), lent):
#     tmp = 0
#     for j in range(8):
#         (R, out) = lfsr(R, mask)
#         tmp = (tmp << 1) ^ out
#     ans += (chr(tmp ^ cip[i]))
#
# print(ans)

# MT19937 randcrack
from hashlib import md5
from randcrack import RandCrack
def foo(l,i):
    a=[]
    a.append(l[i])
    b1=l[i+1]>>32
    b2=l[i+1]&(2**32-1)
    a.append(b2)
    a.append(b1)
    b1=l[i+2]>>64
    b2=(l[i+2]&(2**64-1))>>32
    b3=l[i+2]&(2**32-1)
    a.append(b3)
    a.append(b2)
    a.append(b1)
    return a

def mt19937(filename):
    with open(filename,'r') as f:
        l=f.readlines()
    l=[int(i.strip()) for i in l]
    ll=[]
    for i in range(0,len(l),3):
        ll+=foo(l,i)
    rc=RandCrack()
    for i in ll:
        rc.submit(i)
    aa=rc.predict_getrandbits(32)
    print(md5(str(aa).encode()).hexdigest())


# mask=0b10100100000010000000100010010100 #0,2,5,12,20,24,27,29

# lfsr 求逆

def solve(c):
    li = []
    for i in range(32):
        temp = '1' + ''.join(li) + c[:31 - len(li)]
        if int(temp[0]) ^ int(temp[2]) ^ int(temp[5]) ^ int(temp[12]) ^ int(temp[20]) ^ int(temp[24]) ^ int(
                temp[27]) ^ int(temp[29]) == int(c[31 - len(li)]):

            li.insert(0, '1')
        else:

            li.insert(0, '0')
    return li




# flag{926201d7} 在buuctf提交时要添加0x,为此白给了好多次.
def re_lfsr(mask,output):
    N = 32
    with open(output, 'rb') as f:
        b = f.read()
    key = ''
    for i in range(N // 8):
        t = ord(long_to_bytes(b[i]))
        for j in range(7, -1, -1):
            key += str(t >> j & 1)
    idx = 0
    ans = ""
    key = key[31] + key[:32]
    while idx < 32:
        tmp = 0
        for i in range(32):
            if mask >> i & 1:
                tmp ^= int(key[31 - i])
        ans = str(tmp) + ans
        idx += 1
        key = key[31] + str(tmp) + key[1:31]
    num = int(ans, 2)
    print(hex(num))

# sage
# output -> mask / seed  B-M算法
# in : output输出序列 ； length掩码长度
# return : mask
# def BM(output,length):
#     with open(output,'r') as f:
#         out = f.read()
#         print(out)
#         s = int(x) for x in out
#
#     M = matrix(GF(2),length,length)
#     T = vector(GF(2),length)
#     s = [int(x) for x in '0100110011101111011111011010100111001010010100001111110110111101011110011111010010010111011100110111011001100001010010011101101000110110000011111011110000010100001001000011001011011011011001111110101111001010011011100010011110101100100101111001011100011110111101001010000000100100000111100101100100100000100110001111110011100110101000110100011001110110000110111111010111000001101110011001101111010110101000101011110111001011001111111000100100100011100100010101001100111011101111100110101011101101001001110010111011010011111001100001111111100001000001101101000001010100110011001101000101001010001001011000010111111100101111000000101000010110100110101001001100100011000111101000110011110101101111100110101010101000000001110010101001001111101001010111011110110001100101001111110111000110101011011010110101100011110010000011000110010111101010010000011101110111100011011110110001111010101011101100101101001111100100011000100101111011110001111100000110111000111111000111100000110011011011111110011111100010010110000010011100001010101011011101100011001100101100011001010010001101010011000000011110110111000000110001010010111110101011100000010100100001101011010101100110000101100010001010010111011000100001000001001110101011000010111000000010101100001010000010110110000111100011011000010111001111101110111010110000011001011101100000100000100010100100000010011010000111110010001111010000100011110000101111000110100010110101110001011101101100111000001110100100000000010011001110101110000001101100000001010111010011111000101101011001010011001101000111000010111111010101000011011001001110000011100100100010110101100001110110111001000001011111100101100011010010010110000011110100110000111011011010101110101001100110100101100101000100011001011000001011110010000011000110111011110011010001101100010010111110101101101110100111010000001101000011011010011110111101000000100011000000101001000000011010101010000100001110110000110011000111101011100100101111101111111110101000011010001101100010010100111000000010000101100100110101000001001011100011111001101001101100010100000111010101111011101111111101100000010000111110011101010100101110100101010100011110100100000111010001000100011010011100010011000001110110100110110010100100110111011001010010010100000110101110000011110010110100010101000110000111101011011010111101100111100101001101001101100111101000100101101100010111010010111100100111101101110101110011010110011111011111010000011000100010010101110001001000111111100100010100000001001010111010100010111001011011101110010110111110110100011111101110111011000111001010010110001001011011100110101111100100000101110000001011110011101110101101001011111100011001100111001011011001011011101000101100100011101000011101011010110010111111010011110111111111100001101101001101101111000100110010010100000100000100110100100110010000100101100000101010101000111110101001111111011011111101101110010100110000010110111001101110011101100001111111001110110010010011101111100111111000010011010010011100000001010011111111110001111110110110110001001001111011001101110110101100011010001111110010001011010000011110101100110010010001110010100010000000010101010010111011010101011011000010010011010110101101011100100101110001100000111110010101100010100010100010000101111000011111000111000011110001110110000011000100110010101111111111100011010000010010010111111110000000010100100101101101010111011000001010000000101011010110011101000110011011001110101101001001101100010011110001101001001000011001101100001101100000101111000001110100001100001000100000000011010011001001011110011000011011000100011011001011100111111000011011010000100000011110110011011110111000001011101101110110101000101011111110000100000111111110011111111100010101001000011010001110111111011100010111001110110001000101010001001001111111110111001101001001000110000110100000000010010100001010111101001110001011101011000100000001001001011111000100011111000011010001110001111111110111100010001110101011101011100010100000011110000100011001100000100111000111011011101000110010011010011110010010000111010001011111111010110011100111011110100111000101100100111001001010001000100011110101100100010000000000110010111101101111101011001101111000000000100000101001011110000010011110011000000100111001001110001000010011111010100001001010010100111111010111001001110110101010010100010010100101100000001010010111101101000110100111110000000111110000011110011001101010111101010111010111010000000110010001011110101110110001000110111101110101101001001100001101110001000100000110100000100000111110010110110010011111100010011111001110111011010101010001011111110000000011110001010011001101010110010101100101100110010111001100100111101000100010100010010100000010010111101100111110101101111101001010110010001111111001101010111110101111001000111101001110100000111111010000111000010101001001101100111001111111111100011010111110001101000100001010000000001101101001110001000001110010000010110001001001101010111111001001010100011011111011000011001001101000110010101000010100001001000011111001101101111011111001000010010111011010110010011010101100100000101100110110011011110000110011000000001011000111100101000011011011010010111000110101110101111100100010101010101000011000111000010001001000100110101111001001001111100110000101100010011101100001000010100010101110001111110101100101000101110000110010100101100101100101100100111111010100101010011100110100011111001000100010001101111111101011110100111001110101001101000010001011000111101110001010100101101111000110101001011101110110110110110101011010001110011111011110011010100110100111111010101111101111100110000110010111110110100110000011110110111111101111010011010000101010111100001111110110000001000001000011101001010010100100100000001101011101110011001011011110010111101111101010011010000110110101000100010110110101101010110110010011010011111111100001001000110111101001111000011001000010111100110001110110011011011100101011010101100011001111111000100000011100110011001001011000100010110000100001100011010000110110011100000111000010001011010001110010101000100010001001110001011001010000111010010101110001010100011101101110010111100010110010000011010111001101000100111011010100001010011100000100001010100010110100111000000001111100000100011100101011011101111111101101110011111010000110111101000001001110111000001000101100110100100111100100011011100010011111101010001101010100101110000110011000100001111100100001000000100011101101011011111000011110010110110101010011101000001111001011100101001001101111000011110000001010011010001110000111001101100011110011001100000111101001011000110111011001101101101100101100110100101011111111110110000111101000000100101011100111001111111011010100110010001000001101010001110010010000101111000001010100000101100000010101110100000000110011001011000011101101000000100111111010111110100011111101100001001110001100101100001010000100000110111101001101010000011100000000100000101101010010101111101100110110111000011100111001010010100101000111011001001110011111100010010010110100111101100110110111001011110010000111011111010101000010001101110011111010110011100010001111111011100110100011110110001101001110001010001110011110101111101011101100000111011011101110000110111101010001000011110011011101100011100101110100000100010110110011010101011000010010110000000100010011001110010011110010110111001111011010101111011000000111110000011011100100010011110010110000001111110111000100111010100110010111100010000110101011110011010110011001011011010010111001000000000001001010101010001100000110111101000000010100100010100101011111110011011100111101001110101010001100000100100110111110001111000011100010110001101101010011001011111101011000110110000111111101100000000001000010010010011101001000111100000010111011011001001100110000101010110001011000001011010111000111100111011010101010011100100100100010000001101001101010111110010100101000001100111110111111110000101111100110001110111010111001111110111100000111011011010111011001111010100010000111011111111000100110110001100000110101000001010010010100111011100000011111110001000010011010101001111010111100011110110110111000000111101010110001100000100001101101001101010111110001101101100101101101001000100000100110111111010011010011111010110110111101001000100010111101100011010111011111010011110000100001100101101111110010101000000101111101000001111110100000001011011111111100100110101101011100101101001011010001100010101101100000101000001110110101010100001011100010000111010011101110000000010000000000010111100111000010000000110110011011101110000001111011100011101111100011000011001000100111010101011010101110011010011011011010100011011000110111101001110011110000100010011000010000001101010010011000111000000000101100011010001000100010100100100011000101110100010001111101001010100001000000110010011101011101000000100010000011010110100111110101110001111001000000101011101010111110110100100011010000011010111111001001111101101110111110111000001010111100010001001001100000000110011100001100100111010011111011001010001101111111000010110101000011100001010110100101110111001001100000000110110101011001110000011001111100001101110100101101111100110001010011011001010110111000100010000110001111101110011100001101000100110000111000110001011011110100010101011011001001111101001110011100001110001010100011001110110101101001101010101001110011110001011101011100100001101100110110110101011101010110011100000001011010111011101000000101110111110010000000000101001110011111011001110001100010111001010010110011100001000011111101111101100111000101011100011000001100000000000010000111111010010101110101011100010100001000000100111111010111110010010111010110010100111000010111100000000100010111010010011010011001100010001000001100110100101110100110110111101010001100001010011111011100000010110110110000000100101100110100101100111001010100010001011010001010011110100110101000110001110000100111111001000110011110010111000110010001111111111101011110100111101001001101110110011111000110010111000011011111001110101101101000011010101011010111101011101111011100101001111111000101100100000011000100101001011001011110001101001100101001']
#
#     for i in range(len(s) - length):
#         M[i] = s[i : i + length]
#         T[i] = s[i + length]
#
#     try:
#         mask = M.inverse() * T
#         print(hex(int(''.join(map(str, (mask))), base=2)))
#         return mask
#     except:
#         return


if __name__ == "__main__":
    #mt19937("random.txt")
    # mask = 0b10100100000010000000100010010100
    # re_lfsr(mask,"key")
    s = 0xc1773368a9a19fea0782a735
    print(int(s))